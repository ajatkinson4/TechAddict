<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tailored Agents - Custom Tech. Smart Results.</title>
    
    <!-- Firebase Scripts -->
    <script defer src="/__/firebase/10.7.1/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/10.7.1/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/init.js"></script>
    
    <!-- Calendly Embed -->
    <link rel="stylesheet" href="https://assets.calendly.com/assets/external/widget.css">
    <script defer src="https://assets.calendly.com/assets/external/widget.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #4A90E2;
            --soft-blue: #7BB3E8;
            --charcoal: #2C3E50;
            --light-gray: #F8F9FA;
            --white: #FFFFFF;
            --text-gray: #6C757D;
            --hover-blue: #357ABD;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--charcoal);
            overflow-x: hidden;
        }

        /* Navigation */
        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--charcoal);
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-blue);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .nav-links a:hover {
            color: var(--primary-blue);
        }

        .mobile-menu-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .mobile-menu-toggle span {
            width: 25px;
            height: 3px;
            background: var(--charcoal);
            margin: 3px 0;
            transition: 0.3s;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--light-gray) 0%, #E8F0FE 100%);
            padding: 120px 0 80px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(74, 144, 226, 0.1) 0%, transparent 70%);
            animation: pulse 20s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--charcoal);
            margin-bottom: 1rem;
            animation: fadeInUp 0.8s ease;
        }

        .hero .tagline {
            font-size: 1.5rem;
            color: var(--primary-blue);
            margin-bottom: 2rem;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        .cta-button {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: var(--primary-blue);
            color: var(--white);
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
            animation: fadeInUp 0.8s ease 0.4s both;
        }

        .cta-button:hover {
            background: var(--hover-blue);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Section Styles */
        section {
            padding: 80px 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        h2 {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 3rem;
            color: var(--charcoal);
        }

        /* About Section */
        .about {
            background: var(--white);
        }

        .about-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-gray);
            line-height: 1.8;
        }

        /* Services Section */
        .services {
            background: var(--light-gray);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .service-card {
            background: var(--white);
            padding: 2.5rem;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), var(--soft-blue));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }

        .service-card:hover::before {
            transform: scaleX(1);
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .service-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .service-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--charcoal);
        }

        .service-card p {
            color: var(--text-gray);
            line-height: 1.6;
        }

        /* Portfolio Section */
        .portfolio {
            background: var(--white);
        }

        .portfolio-controls {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .filter-button {
            padding: 0.6rem 1rem;
            border: 1px solid #E0E0E0;
            background: var(--white);
            color: var(--charcoal);
            border-radius: 999px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-button:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .filter-button.active {
            background: var(--primary-blue);
            border-color: var(--primary-blue);
            color: var(--white);
        }

        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .portfolio-card {
            background: var(--white);
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .portfolio-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .portfolio-cover {
            position: relative;
            width: 100%;
            padding-top: 56.25%;
            background: #f3f4f6;
            overflow: hidden;
        }

        .portfolio-cover img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .portfolio-body {
            padding: 1.25rem 1.25rem 1rem;
        }

        .portfolio-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--charcoal);
            margin-bottom: 0.4rem;
        }

        .portfolio-desc {
            color: var(--text-gray);
            margin-bottom: 0.75rem;
        }

        .tag-list {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .tag {
            font-size: 0.85rem;
            background: var(--light-gray);
            color: var(--charcoal);
            padding: 0.25rem 0.6rem;
            border-radius: 999px;
        }

        .view-button {
            margin-top: 0.9rem;
            display: inline-block;
            background: var(--primary-blue);
            color: var(--white);
            padding: 0.6rem 1rem;
            border-radius: 999px;
            text-decoration: none;
            cursor: pointer;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-overlay.open { display: flex; }

        .modal {
            background: var(--white);
            width: min(900px, 92vw);
            max-height: 88vh;
            overflow: auto;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.25);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid #eee;
        }

        .modal-body { padding: 1.25rem; }

        .modal-close {
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-images {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .modal-images img { width: 100%; border-radius: 8px; }

        .modal-links { margin-top: 1rem; display: flex; gap: 0.75rem; flex-wrap: wrap; }

        .link-button {
            display: inline-block;
            padding: 0.6rem 1rem;
            border-radius: 999px;
            text-decoration: none;
            background: var(--light-gray);
            color: var(--charcoal);
        }

        /* Chatbot Demo */
        .chatbot-demo { background: var(--light-gray); }

        .chatbot-grid {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 2rem;
            align-items: start;
        }

        .chatbot-card {
            background: var(--white);
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            padding: 1.25rem;
        }

        .chat-conversation { display: flex; flex-direction: column; gap: 0.75rem; }
        .chat-bubble { padding: 0.8rem 1rem; border-radius: 12px; max-width: 85%; }
        .chat-user { align-self: flex-end; background: #e8f0fe; }
        .chat-assistant { align-self: flex-start; background: #f3f4f6; }

        .chatbot-screenshot img { width: 100%; border-radius: 12px; display: block; }

        /* Why Choose Us Section */
        .why-us {
            background: var(--white);
        }

        .why-us-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .why-us-list {
            list-style: none;
            padding: 0;
        }

        .why-us-list li {
            padding: 1.5rem 0;
            border-bottom: 1px solid #E0E0E0;
            position: relative;
            padding-left: 3rem;
        }

        .why-us-list li:last-child {
            border-bottom: none;
        }

        .why-us-list li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            top: 1.5rem;
            width: 2rem;
            height: 2rem;
            background: var(--primary-blue);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .why-us-list h4 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: var(--charcoal);
        }

        .why-us-list p {
            color: var(--text-gray);
        }

        /* Contact Section */
        .contact {
            background: var(--light-gray);
        }

        .contact-content {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .contact-intro {
            margin-bottom: 2rem;
            color: var(--text-gray);
            font-size: 1.1rem;
        }

        .contact-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            color: var(--charcoal);
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            padding: 1rem;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .submit-button {
            padding: 1rem 2.5rem;
            background: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        .submit-button:hover {
            background: var(--hover-blue);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
        }

        /* Footer */
        .footer {
            background: var(--charcoal);
            color: var(--white);
            text-align: center;
            padding: 2rem 0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: var(--white);
                flex-direction: column;
                padding: 2rem;
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            }

            .nav-links.active {
                display: flex;
            }

            .mobile-menu-toggle {
                display: flex;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero .tagline {
                font-size: 1.2rem;
            }

            h2 {
                font-size: 2rem;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 2rem;
            }

            .cta-button {
                padding: 0.8rem 2rem;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#home" class="logo">Tailored Agents</a>
            <ul class="nav-links" id="navLinks">
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#portfolio">Portfolio</a></li>
                <li><a href="#why-us">Why Us</a></li>
                <li><a href="#contact">Schedule</a></li>
            </ul>
            <div class="mobile-menu-toggle" id="mobileMenu">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1>Tailored Agents</h1>
            <p class="tagline">Custom Tech. Smart Results.</p>
            <a href="#contact" class="cta-button">Get a Free Consultation</a>
        </div>
    </section>

    <!-- Portfolio Section -->
    <section class="portfolio" id="portfolio">
        <div class="container">
            <h2>Portfolio</h2>
            <div class="portfolio-controls" id="portfolioFilters"></div>
            <div class="portfolio-grid" id="portfolioGrid"></div>
        </div>
    </section>

    <!-- Chatbot Demo Section -->
    <section class="chatbot-demo" id="chatbot-demo">
        <div class="container">
            <h2>AI Chatbot Demo</h2>
            <div class="chatbot-grid">
                <div class="chatbot-card">
                    <h3 id="chatbotHeadline"></h3>
                    <p class="contact-intro" id="chatbotSubheadline"></p>
                    <div id="chatbotFeatures"></div>
                    <div class="chat-conversation" id="chatbotConversation"></div>
                    <a id="chatbotCta" class="view-button" href="#contact"></a>
                </div>
                <div class="chatbot-card chatbot-screenshot">
                    <img id="chatbotScreenshot" alt="Chatbot demo screenshot" />
                </div>
            </div>
        </div>
    </section>
    <!-- About Section -->
    <section class="about" id="about">
        <div class="container">
            <h2>About Us</h2>
            <div class="about-content">
                <p>At Tailored Agents, we specialize in delivering customized technology solutions designed specifically for small businesses and professionals. We understand that every business is unique, which is why we craft personalized tech strategies that align perfectly with your goals, helping you work smarter and achieve better results.</p>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="services" id="services">
        <div class="container">
            <h2>Our Services</h2>
            <div class="services-grid">
                <div class="service-card">
                  <div class="service-icon">ü§ñ</div>
                    <h3>AI Consulting & Solutions</h3>
                    <p>From custom GPTs to intelligent workflows, we help you use AI practically and effectively.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">‚ö°</div>
                    <h3>Custom Automation</h3>
                    <p>Automate repetitive tasks with smart systems that save time and reduce errors.</p>
                </div>
                <div class="service-card">
                  <div class="service-icon">üåê</div>
                  <h3>Website & App Building</h3>
                  <p>We create responsive, fast, and beautiful websites and apps that get results.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Why Choose Us Section -->
    <section class="why-us" id="why-us">
        <div class="container">
            <h2>Why Choose Us</h2>
            <div class="why-us-content">
                <ul class="why-us-list">
                    <li>
                        <h4>Personalized Approach</h4>
                        <p>Every solution is tailored to your specific needs and goals, ensuring maximum impact for your business.</p>
                    </li>
                    <li>
                        <h4>Fast Turnaround</h4>
                        <p>We deliver high-quality solutions quickly, so you can start seeing results without lengthy delays.</p>
                    </li>
                    <li>
                        <h4>Ongoing Support</h4>
                        <p>Our relationship doesn't end at delivery. We provide continuous support to ensure your success.</p>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Schedule Section (Calendly) -->
    <section class="contact" id="contact">
        <div class="container">
            <h2>Schedule a Call</h2>
            <div class="contact-content">
                <p class="contact-intro">Pick a time that works best for you.</p>
                <div id="calendlyContainer" class="calendly-inline-wrapper"></div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <!-- <p>&copy; 2025 Tailored Agents. All rights reserved.</p> -->
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        const mobileMenu = document.getElementById('mobileMenu');
        const navLinks = document.getElementById('navLinks');

        mobileMenu.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });

        // Close mobile menu when clicking a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('active');
            });
        });

        // Navbar background on scroll
        window.addEventListener('scroll', () => {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.style.background = 'rgba(255, 255, 255, 0.98)';
            } else {
                navbar.style.background = 'rgba(255, 255, 255, 0.95)';
            }
        });

        // Firestore-backed content
        const db = firebase.firestore();

        // Portfolio rendering
        async function loadPortfolio() {
            try {
                const snapshot = await db.collection('portfolio_projects').get();
                const projects = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                // Sort by 'order' asc, fallback to createdAt desc
                projects.sort((a, b) => {
                    const ao = typeof a.order === 'number' ? a.order : Number.MAX_SAFE_INTEGER;
                    const bo = typeof b.order === 'number' ? b.order : Number.MAX_SAFE_INTEGER;
                    if (ao !== bo) return ao - bo;
                    const ac = a.createdAt && a.createdAt.toMillis ? a.createdAt.toMillis() : 0;
                    const bc = b.createdAt && b.createdAt.toMillis ? b.createdAt.toMillis() : 0;
                    return bc - ac;
                });

                const services = Array.from(new Set(projects.map(p => (p.service || 'other').toString())));
                renderFilters(services);
                renderProjectGrid(projects);

                // Filter logic
                const filterContainer = document.getElementById('portfolioFilters');
                filterContainer.addEventListener('click', (e) => {
                    const btn = e.target.closest('.filter-button');
                    if (!btn) return;
                    const service = btn.dataset.service;
                    [...filterContainer.children].forEach(c => c.classList.remove('active'));
                    btn.classList.add('active');
                    const filtered = service === 'all' ? projects : projects.filter(p => (p.service || 'other') === service);
                    renderProjectGrid(filtered);
                });
            } catch (err) {
                console.error('Failed to load portfolio:', err);
                document.getElementById('portfolioGrid').innerHTML = '<p style="text-align:center;color:var(--text-gray)">Portfolio will appear here soon.</p>';
            }
        }

        function toTitleCase(str) {
            return str.replace(/[-_]/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
        }

        function renderFilters(services) {
            const container = document.getElementById('portfolioFilters');
            container.innerHTML = '';
            const allBtn = document.createElement('button');
            allBtn.className = 'filter-button active';
            allBtn.dataset.service = 'all';
            allBtn.textContent = 'All';
            container.appendChild(allBtn);
            services.forEach(svc => {
                const btn = document.createElement('button');
                btn.className = 'filter-button';
                btn.dataset.service = svc;
                btn.textContent = toTitleCase(svc);
                container.appendChild(btn);
            });
        }

        function renderProjectGrid(projects) {
            const grid = document.getElementById('portfolioGrid');
            grid.innerHTML = '';
            if (!projects.length) {
                grid.innerHTML = '<p style="text-align:center;color:var(--text-gray)">No projects yet.</p>';
                return;
            }
            projects.forEach(p => {
                const coverUrl = (Array.isArray(p.images) && p.images[0] && p.images[0].url) ? p.images[0].url : '';
                const coverAlt = (Array.isArray(p.images) && p.images[0] && p.images[0].alt) ? p.images[0].alt : p.title || 'Project image';
                const card = document.createElement('div');
                card.className = 'portfolio-card';
                card.innerHTML = `
                    <div class=\"portfolio-cover\">${coverUrl ? `<img src=\"${coverUrl}\" alt=\"${coverAlt}\">` : ''}</div>
                    <div class=\"portfolio-body\">
                        <div class=\"portfolio-title\">${p.title || 'Untitled Project'}</div>
                        <div class=\"portfolio-desc\">${p.shortDescription || ''}</div>
                        <div class=\"tag-list\">${(p.tags || []).map(t => `<span class=\\\"tag\\\">${t}</span>`).join('')}</div>
                        <button class=\"view-button\" data-id=\"${p.id}\">View details</button>
                    </div>
                `;
                grid.appendChild(card);
            });
            // Bind open modal
            grid.querySelectorAll('.view-button').forEach(btn => {
                btn.addEventListener('click', () => {
                    const project = projects.find(x => x.id === btn.dataset.id);
                    if (project) openProjectModal(project);
                });
            });
        }

        // Modal
        const modalOverlay = document.createElement('div');
        modalOverlay.className = 'modal-overlay';
        modalOverlay.innerHTML = `
            <div class=\"modal\" role=\"dialog\" aria-modal=\"true\">
                <div class=\"modal-header\">
                    <h3 id=\"modalTitle\" style=\"margin:0\"></h3>
                    <button class=\"modal-close\" aria-label=\"Close\">√ó</button>
                </div>
                <div class=\"modal-body\">
                    <div class=\"modal-images\" id=\"modalImages\"></div>
                    <div id=\"modalDescription\" style=\"color:var(--text-gray)\"></div>
                    <div class=\"modal-links\" id=\"modalLinks\"></div>
                </div>
            </div>`;
        document.body.appendChild(modalOverlay);
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay || e.target.classList.contains('modal-close')) closeProjectModal();
        });

        function openProjectModal(project) {
            document.getElementById('modalTitle').textContent = project.title || 'Project';
            const imagesEl = document.getElementById('modalImages');
            imagesEl.innerHTML = (project.images || []).map(img => `<img src=\"${img.url}\" alt=\"${img.alt || 'Project image'}\">`).join('');
            document.getElementById('modalDescription').textContent = project.longDescription || '';
            const linksEl = document.getElementById('modalLinks');
            linksEl.innerHTML = '';
            if (project.liveUrl) linksEl.innerHTML += `<a class=\"link-button\" href=\"${project.liveUrl}\" target=\"_blank\" rel=\"noopener\">Live Site</a>`;
            if (project.repoUrl) linksEl.innerHTML += `<a class=\"link-button\" href=\"${project.repoUrl}\" target=\"_blank\" rel=\"noopener\">Repository</a>`;
            modalOverlay.classList.add('open');
        }

        function closeProjectModal() { modalOverlay.classList.remove('open'); }

        // Chatbot demo rendering
        async function loadChatbotDemo() {
            try {
                const doc = await db.collection('chatbot_demo').doc('default').get();
                if (!doc.exists) return;
                const data = doc.data();
                const headline = document.getElementById('chatbotHeadline');
                const sub = document.getElementById('chatbotSubheadline');
                const features = document.getElementById('chatbotFeatures');
                const convo = document.getElementById('chatbotConversation');
                const cta = document.getElementById('chatbotCta');
                const shot = document.getElementById('chatbotScreenshot');

                headline.textContent = data.headline || 'AI Chatbot for Professionals';
                sub.textContent = data.subheadline || '';
                features.innerHTML = (data.features || []).map(f => `<div class=\"tag\" style=\"display:inline-block;margin:0 0.4rem 0.4rem 0;\">${f}</div>`).join('');
                convo.innerHTML = (data.sampleConversation || []).map(m => `<div class=\"chat-bubble ${m.role === 'user' ? 'chat-user' : 'chat-assistant'}\">${m.text}</div>`).join('');
                if (data.ctaText) cta.textContent = data.ctaText; else cta.textContent = 'See it in action';
                if (data.ctaLink) cta.href = data.ctaLink;
                if (data.screenshotUrl) shot.src = data.screenshotUrl; else shot.remove();
            } catch (err) {
                console.error('Failed to load chatbot demo:', err);
            }
        }

        // Calendly init from Firestore config
        async function initCalendlyFromConfig() {
            try {
                const doc = await db.collection('site_config').doc('default').get();
                if (!doc.exists) {
                    console.warn('site_config/default not found. Add { calendlyUrl: "https://calendly.com/your-slug" }');
                    return;
                }
                const { calendlyUrl } = doc.data();
                if (!calendlyUrl || !window.Calendly) return;
                const container = document.getElementById('calendlyContainer');
                Calendly.initInlineWidget({
                    url: calendlyUrl,
                    parentElement: container,
                    prefill: {},
                    utm: {}
                });
            } catch (err) {
                console.error('Failed to init Calendly:', err);
            }
        }

        // Kick off loads
        loadPortfolio();
        loadChatbotDemo();
        // Wait a tick for Calendly script (defer) to load
        window.addEventListener('load', () => { initCalendlyFromConfig(); });

        // Smooth scroll behavior for all browsers
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe all sections for animation
        document.querySelectorAll('section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(20px)';
            section.style.transition = 'all 0.6s ease';
            observer.observe(section);
        });
    </script>
</body>
</html>
